Intent: The test case `test2947660` is intended to verify that the method `getLegendItems` correctly retrieves a list of `LegendItem` objects for a `LineAndShapeRenderer` used within a `CategoryPlot`. The test checks for correct initialization (zero items when no data is added), and proper increment and labeling of legend items as data is added to the dataset.

Repair strategy: The source code has a logical error where it returns `result` prematurely if a dataset is found (instead of only when the dataset is null), which prevents the further execution of code that processes the dataset into legend items. The condition to return `result` should be corrected to only occur if `dataset` is `null`. This will allow the subsequent code to execute and add `LegendItem` objects to `result` as expected when the dataset is non-null. Adjust the conditional check around the dataset to ensure that the legend items are created and added to the collection only when the dataset exists and contains data.