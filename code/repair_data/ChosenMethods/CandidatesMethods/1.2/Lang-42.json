{"fillWithHtml40Entities": "    static void fillWithHtml40Entities(Entities entities) {\n        entities.addEntities(BASIC_ARRAY);\n        entities.addEntities(ISO8859_1_ARRAY);\n        entities.addEntities(HTML40_ARRAY);\n    }", "add": "        public void add(String name, int value) {\n            ensureCapacity(size + 1);\n            int insertAt = binarySearch(value);\n            if (insertAt > 0) {\n                return; // note: this means you can't insert the same value twice\n            }\n            insertAt = -(insertAt + 1); // binarySearch returns it negative and off-by-one\n            System.arraycopy(values, insertAt, values, insertAt + 1, size - insertAt);\n            values[insertAt] = value;\n            System.arraycopy(names, insertAt, names, insertAt + 1, size - insertAt);\n            names[insertAt] = name;\n            size++;\n        }", "name": "        public String name(int value) {\n            int index = binarySearch(value);\n            if (index < 0) {\n                return null;\n            }\n            return names[index];\n        }", "value": "        public int value(String name) {\n            for (int i = 0; i < size; ++i) {\n                if (names[i].equals(name)) {\n                    return values[i];\n                }\n            }\n            return -1;\n        }", "createLookupTable": "        private void createLookupTable() {\n            lookupTable = new String[LOOKUP_TABLE_SIZE];\n            for (int i = 0; i < LOOKUP_TABLE_SIZE; ++i) {\n                lookupTable[i] = super.name(i);\n            }\n        }", "ensureCapacity": "        protected void ensureCapacity(int capacity) {\n            if (capacity > names.length) {\n                int newSize = Math.max(capacity, size + growBy);\n                String[] newNames = new String[newSize];\n                System.arraycopy(names, 0, newNames, 0, size);\n                names = newNames;\n                int[] newValues = new int[newSize];\n                System.arraycopy(values, 0, newValues, 0, size);\n                values = newValues;\n            }\n        }", "binarySearch": "        private int binarySearch(int key) {\n            int low = 0;\n            int high = size - 1;\n\n            while (low <= high) {\n                int mid = (low + high) >>> 1;\n                int midVal = values[mid];\n\n                if (midVal < key) {\n                    low = mid + 1;\n                } else if (midVal > key) {\n                    high = mid - 1;\n                } else {\n                    return mid; // key found\n                }\n            }\n            return -(low + 1); // key not found.\n        }", "addEntities": "    public void addEntities(String[][] entityArray) {\n        for (int i = 0; i < entityArray.length; ++i) {\n            addEntity(entityArray[i][0], Integer.parseInt(entityArray[i][1]));\n        }\n    }", "addEntity": "    public void addEntity(String name, int value) {\n        map.add(name, value);\n    }", "entityName": "    public String entityName(int value) {\n        return map.name(value);\n    }", "entityValue": "    public int entityValue(String name) {\n        return map.value(name);\n    }", "escape": "    public void escape(Writer writer, String str) throws IOException {\n        int len = str.length();\n        for (int i = 0; i < len; i++) {\n            char c = str.charAt(i);\n            String entityName = this.entityName(c);\n            if (entityName == null) {\n                if (c > 0x7F) {\n                    writer.write(\"&#\");\n                    writer.write(Integer.toString(c, 10));\n                    writer.write(';');\n                } else {\n                    writer.write(c);\n                }\n            } else {\n                writer.write('&');\n                writer.write(entityName);\n                writer.write(';');\n            }\n        }\n    }", "unescape": "    public void unescape(Writer writer, String str) throws IOException {\n        int firstAmp = str.indexOf('&');\n        if (firstAmp < 0) {\n            writer.write(str);\n            return;\n        } else {\n            doUnescape(writer, str, firstAmp);\n        }\n    }", "createStringWriter": "    private StringWriter createStringWriter(String str) {\n        return new StringWriter((int) (str.length() + (str.length() * 0.1)));\n    }", "doUnescape": "    private void doUnescape(Writer writer, String str, int firstAmp) throws IOException {\n        writer.write(str, 0, firstAmp);\n        int len = str.length();\n        for (int i = firstAmp; i < len; i++) {\n            char c = str.charAt(i);\n            if (c == '&') {\n                int nextIdx = i + 1;\n                int semiColonIdx = str.indexOf(';', nextIdx);\n                if (semiColonIdx == -1) {\n                    writer.write(c);\n                    continue;\n                }\n                int amphersandIdx = str.indexOf('&', i + 1);\n                if (amphersandIdx != -1 && amphersandIdx < semiColonIdx) {\n                    // Then the text looks like &...&...;\n                    writer.write(c);\n                    continue;\n                }\n                String entityContent = str.substring(nextIdx, semiColonIdx);\n                int entityValue = -1;\n                int entityContentLen = entityContent.length();\n                if (entityContentLen > 0) {\n                    if (entityContent.charAt(0) == '#') { // escaped value content is an integer (decimal or\n                        // hexidecimal)\n                        if (entityContentLen > 1) {\n                            char isHexChar = entityContent.charAt(1);\n                            try {\n                                switch (isHexChar) {\n                                    case 'X' :\n                                    case 'x' : {\n                                        entityValue = Integer.parseInt(entityContent.substring(2), 16);\n                                        break;\n                                    }\n                                    default : {\n                                        entityValue = Integer.parseInt(entityContent.substring(1), 10);\n                                    }\n                                }\n                                if (entityValue > 0xFFFF) {\n                                    entityValue = -1;\n                                }\n                            } catch (NumberFormatException e) {\n                                entityValue = -1;\n                            }\n                        }\n                    } else { // escaped value content is an entity name\n                        entityValue = this.entityValue(entityContent);\n                    }\n                }\n\n                if (entityValue == -1) {\n                    writer.write('&');\n                    writer.write(entityContent);\n                    writer.write(';');\n                } else {\n                    writer.write(entityValue);\n                }\n                i = semiColonIdx; // move index up to the semi-colon\n            } else {\n                writer.write(c);\n            }\n        }\n    }"}